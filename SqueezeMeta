###SqueezeMeta运行###
#配置环境与包#
conda update -n base conda # if your conda version is below 22.11
conda install -n base conda-libmamba-solver
conda config --set solver libmamba
#conda create -n SqueezeMeta
#conda install -c bioconda -c fpusan squeezemeta
conda create -n SqueezeMeta -c bioconda -c fpusan  squeezemeta

#下载数据库数据
#最新数据库资源
perl /mnt/raid5/User/bailin/miniconda3/envs/mNGS/SqueezeMeta/utils/install_utils/make_databases.pl /mnt/raid5/User/bailin/Metagenomics/mNGS/databases-download/
#更快一些的旧版，建议使用
#后台挂起下载
nohup perl /mnt/raid5/User/bailin/miniconda3/envs/mNGS/SqueezeMeta/utils/install_utils/download_databases.pl /mnt/raid5/User/bailin/Metagenomics/mNGS/databases-download/ > output.log 2>&1 &
#配置数据库
/mnt/raid5/User/bailin/miniconda3/envs/SqueezeMeta/SqueezeMeta/utils/install_utils/configure_nodb.pl /mnt/raid5/User/bailin/Metagenomics/mNGS/SQMdata/db
#检查安装包和依赖文件是否正常
perl /mnt/raid5/User/bailin/miniconda3/envs/SqueezeMeta/SqueezeMeta/utils/install_utils/test_install.pl
#不要提前新建存放结果的test文件,注意给出文件目录
nohup SqueezeMeta.pl -m coassembly -p /mnt/raid5/User/bailin/Metagenomics/mNGS/test1/test02 -s /mnt/raid5/User/bailin/Metagenomics/mNGS/updata/scatter_A/tsv/RNA_data_no_sutiable/inputsamples_file.sample -f /mnt/raid5/User/bailin/Metagenomics/mNGS/updata/scatter_A/tsv/RNA_data_no_sutiable/raw/ > output.log 2>&1 &
#重启
SqueezeMeta.pl test01 --restart

###SQMtools可视化部分###
conda activate SqueezeMeta
Rscript /mnt/raid5/User/bailin/Metagenomics/mNGS/test1/script/SQMtools.txt /mnt/raid5/User/bailin/Metagenomics/mNGS/test1/test01 /mnt/raid5/User/bailin/Metagenomics/mNGS/test1/SQMtool_result 2000 2000
